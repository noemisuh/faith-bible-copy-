# 환경 초기화 이후 다시 마태복음 1장 마이크 하단 고정형 HTML 재생성 및 압축

import os
from zipfile import ZipFile

verses = [
    "亚伯拉罕的后裔、大卫的子孙、耶稣基督的家谱：",
    "亚伯拉罕生以撒；以撒生雅各；雅各生犹大和他的弟兄；",
    "犹大从他玛氏生法勒斯和谢拉；法勒斯生希斯仑；希斯仑生亚兰；",
    "亚兰生亚米拿达；亚米拿达生拿顺；拿顺生撒门；",
    "撒门从喇合氏生波阿斯；波阿斯从路得氏生俄备得；俄备得生耶西；",
    "耶西生大卫王；大卫从乌利亚的妻子生所罗门；",
    "所罗门生罗波安；罗波安生亚比雅；亚比雅生亚撒；",
    "亚撒生约沙法；约沙法生约兰；约兰生乌西亚；",
    "乌西亚生约坦；约坦生亚哈斯；亚哈斯生希西家；",
    "希西家生玛拿西；玛拿西生亚们；亚们生约西亚；",
    "百姓被迁到巴比伦的时候、约西亚生耶哥尼雅和他的弟兄；",
    "迁到巴比伦之后、耶哥尼雅生撒拉铁；撒拉铁生所罗巴伯；",
    "所罗巴伯生亚比玉；亚比玉生以利亚敬；以利亚敬生亚所；",
    "亚所生撒督；撒督生亚金；亚金生以律；",
    "以律生以利亚撒；以利亚撒生马但；马但生雅各；",
    "雅各生约瑟，就是马利亚的丈夫；那称为基督的耶稣，是从马利亚生的。",
    "这样，从亚伯拉罕到大卫共十四代；从大卫到迁到巴比伦的时候也共十四代；从迁到巴比伦的时候到基督又共十四代。",
    "耶稣基督降生的事记在下面：他母亲马利亚已经许配了约瑟，还没有迎娶，马利亚就从圣灵怀了孕。",
    "她丈夫约瑟是个义人，不愿意明明地羞辱她，想要暗暗地把她休了。",
    "正思念这事的时候，有主的使者向他梦中显现，说：“大卫的子孙约瑟，不要怕，只管娶过你的妻子马利亚来。因她所怀的孕，是从圣灵来的。",
    "她将要生一个儿子，你要给他起名叫耶稣，因他要将自己的百姓从罪恶里救出来。”",
    "这一切的事成就，是要应验主借先知所说的话：",
    "说：“必有童女怀孕生子，人要称他的名为以马内利。”（“以马内利”翻出来就是“神与我们同在”。）",
    "约瑟醒了，起来，就遵着主使者的吩咐把妻子娶过来；",
    "只是没有和她同房，等她生了儿子，就给他起名叫耶稣。"
]

output_dir = "/mnt/data/matthew1_mic_fixed"
os.makedirs(output_dir, exist_ok=True)
html_path = os.path.join(output_dir, "matthew1_mic_fixed.html")

# HTML 생성
html = """<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>马太福音 第1章</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: sans-serif; margin: 0; background: #f9f9f9; }
.container { max-width: 800px; margin: 0 auto; padding: 20px; }
.top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.top-bar a { text-decoration: none; color: #1a73e8; font-size: 14px; }
.search-boxes input { padding: 5px; margin-left: 4px; font-size: 14px; width: 120px; }
h1 { font-size: 18px; text-align: center; margin: 10px 0; }
.nav { text-align: center; margin-bottom: 10px; }
.nav a { margin: 0 10px; font-size: 14px; text-decoration: none; color: #1a73e8; }
.verse { margin-bottom: 12px; }
.scripture { background: #e8f0fe; padding: 10px; border-left: 4px solid #4285f4; font-size: 14px; line-height: 1.4; }
textarea { width: 100%; font-size: 14px; padding: 8px; border: 1px solid #ccc; border-radius: 4px; resize: none; min-height: 50px; }
#micFixed {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: #1a73e8;
  color: white;
  padding: 14px 16px;
  font-size: 18px;
  border: none;
  border-radius: 50%;
  z-index: 999;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
}
</style>
<script>
let currentTarget = null;
document.addEventListener('DOMContentLoaded', () => {
  const textareas = document.querySelectorAll("textarea");
  textareas.forEach(area => {
    area.addEventListener("focus", () => {
      currentTarget = area;
    });
  });
});
function startGlobalListening() {
  if (!currentTarget) {
    alert("请先点击想要输入的经文栏。");
    return;
  }
  const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
  recognition.lang = 'zh-CN';
  recognition.onresult = function(event) {
    currentTarget.value += event.results[0][0].transcript;
  };
  recognition.start();
}
</script>
</head>
<body>
<div class="container">
  <div class="top-bar">
    <a href="#">📚 圣经目录</a>
    <div class="search-boxes">
      <input type="text" placeholder="🔍 章节搜索...">
      <input type="text" placeholder="🔍 关键词搜索...">
    </div>
  </div>
  <h1>📖 马太福音</h1>
  <div class="nav">
    <a href="#">← 第0章</a> <strong>第1章</strong> <a href="#">第2章 →</a>
  </div>
"""

# 구절 삽입
for i, verse in enumerate(verses, 1):
    html += f"""
    <div class="verse">
      <div class="scripture"><strong>{i}节</strong> {verse}</div>
      <textarea placeholder="请抄写或使用语音输入..."></textarea>
    </div>
    """

html += """
</div>
<button id="micFixed" onclick="startGlobalListening()">🎙</button>
</body>
</html>
"""

# 저장
with open(html_path, "w", encoding="utf-8") as f:
    f.write(html)

# 압축
zip_path = "/mnt/data/matthew1_mic_fixed.zip"
with ZipFile(zip_path, "w") as zipf:
    zipf.write(html_path, arcname="matthew1_mic_fixed.html")

zip_path
